<%- include('../partials/header') %>
<%- include('../partials/nav') %>

<div class="container mb-5">
  <h1 class="mb-4">Üzenetek</h1>

  <p class="mb-3">
    Az alábbi táblázatban a <strong>Kapcsolat</strong> menün keresztül beküldött üzenetek
    láthatók, az adatbázis <code>messages</code> táblájából, 
    <strong>fordított időrendben</strong> (a legfrissebb elöl).
  </p>

  <% if (success && success.length) { %>
    <div class="alert alert-success"><%= success %></div>
  <% } %>

  <% if (error && error.length) { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>

  <% if (!messages || messages.length === 0) { %>
    <div class="alert alert-info">
      Jelenleg még nincs egyetlen elmentett üzenet sem.
    </div>
  <% } else { %>

    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Név</th>
            <th scope="col">E-mail</th>
            <th scope="col">Tárgy</th>
            <th scope="col">Üzenet</th>
            <th scope="col">Küldés ideje</th>
          </tr>
        </thead>
        <tbody>
          <% messages.forEach(msg => { %>
            <tr>
              <td><%= msg.id %></td>
              <td><%= msg.name %></td>
              <td><%= msg.email %></td>
              <td><%= msg.subject %></td>
              <td><%= msg.body %></td>
              <td>
                <%= new Date(msg.created_at).toLocaleString('hu-HU') %>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

  <% } %>
</div>

<%- include('../partials/footer') %>
